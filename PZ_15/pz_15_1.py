# Приложение СТРАХОВАЯ КОМПАНИЯ для некоторой организации. БД должна
# содержать таблицу Договор со следующей структурой записи: дата заключения, страховая
# сумма, вид страхования, тарифная ставка и филиал, в котором заключался договор.

import sqlite3 as sq


insurance_data = [
    (1, '2025-01-10', 500000, 'Автострахование', 5.2, 'Центральный'),
    (2, '2025-01-15', 1000000, 'Страхование имущества', 3.8, 'Северный'),
    (3, '2025-02-01', 750000, 'Медицинское страхование', 4.5, 'Центральный'),
    (4, '2025-02-10', 300000, 'Автострахование', 6.0, 'Южный'),
    (5, '2025-03-05', 1200000, 'Страхование жизни', 2.5, 'Восточный'),
    (6, '2025-03-15', 900000, 'Страхование имущества', 3.2, 'Центральный'),
    (7, '2025-04-01', 600000, 'Автострахование', 5.8, 'Западный'),
    (8, '2025-04-10', 1500000, 'Страхование ответственности', 4.0, 'Северный'),
    (9, '2025-05-01', 800000, 'Медицинское страхование', 4.2, 'Южный'),
    (10, '2025-05-10', 200000, 'Автострахование', 7.5, 'Центральный')
]

with sq.connect('insurance_company.db') as con:
    cur = con.cursor()
    cur.execute("DROP TABLE IF EXISTS Договор")
    cur.execute("""CREATE TABLE IF NOT EXISTS Договор(
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        дата_заключения TEXT NOT NULL,
        страховая_сумма INTEGER NOT NULL,
        вид_страхования TEXT NOT NULL,
        тарифная_ставка INTEGER NOT NULL,
        филиал TEXT NOT NULL
    )""")
    cur.executemany("INSERT INTO Договор VALUES(?, ?, ?, ?, ?, ?)", insurance_data)


print("\nДоговоры автострахования:")
cur.execute("SELECT * FROM Договор WHERE вид_страхования = 'Автострахование'")
for row in cur.fetchall():
    print(row)

print("\nДоговоры Центрального филиала:")
cur.execute("SELECT * FROM Договор WHERE филиал = 'Центральный'")
for row in cur.fetchall():
    print(row)

print("\nДоговоры с суммой более 1 млн:")
cur.execute("SELECT * FROM Договор WHERE страховая_сумма > 1000000")
for row in cur.fetchall():
    print(row)


cur.execute("DELETE FROM Договор WHERE id = 4")
print("\nДоговор с id=4 удален")

cur.execute("DELETE FROM Договор WHERE вид_страхования = 'Страхование ответственности'")
print("Договоры страхования ответственности удалены")

cur.execute("DELETE FROM Договор WHERE филиал = 'Южный'")
print("Договоры Южного филиала удалены")


cur.execute("UPDATE Договор SET тарифная_ставка = 5.0 WHERE id = 1")
print("\nТарифная ставка договора 1 изменена на 5.0%")

cur.execute("UPDATE Договор SET филиал = 'Северо-Западный' WHERE филиал = 'Северный'")
print("Филиал 'Северный' переименован в 'Северо-Западный'")

cur.execute("UPDATE Договор SET страховая_сумма = страховая_сумма * 1.1 WHERE вид_страхования = 'Медицинское страхование'")
print("Страховые суммы медстрахования увеличены на 10%")

print('\nТаблица после изменений:')
for row in cur.execute('SELECT * FROM Договор'):
    print(row)